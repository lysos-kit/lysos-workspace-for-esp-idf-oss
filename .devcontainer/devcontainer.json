{
  "name": "ESP-IDF Development",
  "dockerComposeFile": "../docker-compose.yml",
  "service": "esp-idf",
  "workspaceFolder": "/workspace",
  
  // Use the workspace folder
  "remoteUser": "espuser",
  
  // Configure VS Code settings
  "customizations": {
    "vscode": {
      // Install recommended extensions
      "extensions": [
        "ms-vscode.cpptools",
        "ms-vscode.cmake-tools",
        "espressif.esp-idf-extension",
        "twxs.cmake",
        "ms-python.python",
        "ms-python.vscode-pylance",
        "marus25.cortex-debug",
        "redhat.vscode-yaml",
        "streetsidesoftware.code-spell-checker"
      ],
      
      // VS Code settings for the container
      "settings": {
        // C/C++ Configuration
        "C_Cpp.default.compilerPath": "/opt/esp/tools/xtensa-esp-elf/esp-13.2.0_20240530/xtensa-esp-elf/bin/xtensa-esp32s3-elf-gcc",
        "C_Cpp.default.configurationProvider": "ms-vscode.cmake-tools",
        "C_Cpp.default.intelliSenseMode": "gcc-x64",
        
        // ESP-IDF Extension Configuration
        "idf.espIdfPath": "/opt/esp/idf",
        "idf.toolsPath": "/opt/esp",
        "idf.pythonBinPath": "/opt/esp/python_env/idf5.5_py3.11_env/bin/python",
        "idf.port": "/dev/ttyUSB0",
        "idf.baudRate": "115200",
        "idf.flashBaudRate": "115200",
        
        // Terminal Configuration
        "terminal.integrated.defaultProfile.linux": "bash",
        "terminal.integrated.profiles.linux": {
          "bash": {
            "path": "/bin/bash",
            "icon": "terminal-bash"
          }
        },
        
        // File associations
        "files.associations": {
          "*.h": "c",
          "*.c": "c",
          "sdkconfig": "properties",
          "sdkconfig.defaults": "properties"
        },
        
        // Editor settings
        "editor.formatOnSave": true,
        "editor.tabSize": 4,
        "editor.insertSpaces": true,
        
        // Python Configuration
        "python.defaultInterpreterPath": "/opt/esp/python_env/idf5.5_py3.11_env/bin/python",
        "python.linting.enabled": true,
        "python.linting.pylintEnabled": true,
        
        // CMake Configuration
        "cmake.configureOnOpen": false,
        "cmake.buildDirectory": "${workspaceFolder}/build"
      }
    }
  },
  
  // Forward ports for debugging and monitoring
  "forwardPorts": [
    3333, // OpenOCD GDB server
    9333  // OpenOCD telnet server
  ],
  
  // Post-create command (runs after container is created)
  "postCreateCommand": "echo 'ESP-IDF Development Environment Ready!' && idf.py --version",
  
  // Keep container running
  "shutdownAction": "stopCompose",
  
  // Mount the project directory
  "mounts": [
    "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached"
  ],
  
  // Features to install
  "features": {
    "ghcr.io/devcontainers/features/common-utils:2": {
      "installZsh": false,
      "installOhMyZsh": false,
      "upgradePackages": false
    }
  }
}

